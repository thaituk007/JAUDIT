วิธีใช้งาน
วางไฟล์นี้ (เช่น index.php) ในเซิร์ฟเวอร์ PHP ที่มี composer และติดตั้ง phpoffice/phpspreadsheet แล้ว
สร้างโฟลเดอร์ uploads ให้มีสิทธิ์เขียนได้
อัปโหลดไฟล์ Excel .xlsx ที่มีหัวตารางสำคัญ ได้แก่
"จังหวัด"
"หน่วยบริการประจำ"
"หน่วยบริการปฐมภูมิ"
"จำนวนประชากรสิทธิหลักประกันสุขภาพแห่งชาติ"

เลือกเดือนก่อนอัปโหลด (ตามรูปแบบปี-เดือน เช่น 2025-07)
ใช้ตัวกรองจังหวัด, หน่วยบริการประจำ, หน่วยบริการปฐมภูมิ เพื่อดูข้อมูลกราฟวงกลมและตาราง
Export เป็น CSV หรือ Excel ได้

คำแนะนำการใช้งาน
ต้องติดตั้ง PhpSpreadsheet ผ่าน Composer (composer require phpoffice/phpspreadsheet)
สร้างโฟลเดอร์ uploads และเซ็ตรหัสสิทธิ์ให้เว็บเซิร์ฟเวอร์เขียนได้
อัปโหลดไฟล์ Excel ที่มีคอลัมน์อย่างน้อย:
จังหวัด
หน่วยบริการประจำ
หน่วยบริการปฐมภูมิ
จำนวนประชากรสิทธิหลักประกันสุขภาพแห่งชาติ

เลือกเดือนก่อนอัปโหลด และเลือกกรองข้อมูลตามจังหวัด/หน่วยบริการ
กราฟวงกลมขนาดใหญ่ ดูสบายตา ฟอนต์ทันสมัย และแสดงชื่อพร้อมเปอร์เซ็นต์ชัดเจนทางซ้าย
สามารถ Export ข้อมูล CSV และ Excel ได้ทันที


ใช้ Font Prompt รองรับภาษาไทย อ่านง่าย
กราฟวงกลมอยู่ กลางหน้าจอ, ขนาดใหญ่
สีพาสเทลนุ่มตา
Legend แสดงชื่อหน่วยบริการด้านขวา
Tooltip ชัดเจน: จำนวน + เปอร์เซ็นต์
ปิดตัวเลขบนกราฟ (ไม่รก)
รองรับ PHP < 7.0 ได้

ได้ครับ! นี่คือ โค้ด PHP ฉบับเต็ม ที่แก้ไขให้

เรียงชื่อหน่วยบริการปฐมภูมิ ($populationByService) ตามลำดับตัวอักษร A-Z ด้วย ksort()
ฟอนต์ Prompt อ่านง่าย รองรับภาษาไทย
กราฟวงกลมใหญ่กลางหน้าจอ สีพาสเทลนุ่มตา
Legend ชื่อหน่วยบริการด้านขวา
Tooltip แสดงจำนวน + เปอร์เซ็นต์
ปิดตัวเลขบนกราฟ (ไม่รก)
รองรับ PHP < 7.0
แสดงจำนวนหน่วยบริการปฐมภูมิที่เลือก (จำนวน “แห่ง”)
ฟอร์มอัปโหลด แยกเดือน และฟิลเตอร์จังหวัด, หน่วยบริการประจำ, หน่วยบริการปฐมภูมิ พร้อม export CSV / Excel

use PhpOffice\PhpSpreadsheet\IOFactory;
use PhpOffice\PhpSpreadsheet\Spreadsheet;
use PhpOffice\PhpSpreadsheet\Writer\Xlsx;

รวมจำนวนประชากรสิทธิหลักประกันสุขภาพแห่งชาติ: <?= number_format($sumPopulation) ?> ราย